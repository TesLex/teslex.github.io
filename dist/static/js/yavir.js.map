{"version":3,"sources":["../../../static/js/yavir.js"],"names":["$route","$data","$mode","x","el","X","type","callback","exec","e","addEventListener","content","tmp","innerHTML","clazz","split","forEach","classList","add","c","remove","hasClass","contains","style","appendChild","document","createElement","what","to","replace","querySelectorAll","Yavir","app","path","route","names","match","RegExp","params","i","length","component","tpl","template","start","indexOf","end","substr","selector","html","window","eval","script","q","val","trim","title","components","renderComponent","removeClass","found","find","location","hash","pathname","addClass","mode","history","replaceState","undefined","renderActive","on","url","href","pushState","dispatchEvent","Event","page","file","async","rawFile","XMLHttpRequest","s","open","onreadystatechange","readyState","status","responseText","send","log","text","console"],"mappings":"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","file":"yavir.js","sourcesContent":["let $route = {};\nlet $data = {};\nlet $mode = 'hash';\n\nfunction x(el) {\n\treturn new X(el)\n}\n\nclass X {\n\tconstructor(el) {\n\t\tthis.el = el\n\t}\n\n\ton(type, callback) {\n\t\tthis.exec(e => e.addEventListener(type, callback))\n\t}\n\n\thtml(content) {\n\t\tlet tmp;\n\n\t\tif (typeof content !== 'undefined')\n\t\t\treturn this.exec(e => e.innerHTML = content);\n\t\telse\n\t\t\tthis.exec(e => tmp = e.innerHTML);\n\n\t\treturn tmp ? tmp : new X(this.el)\n\t}\n\n\taddClass(clazz) {\n\t\treturn this.exec(e => {\n\t\t\tclazz.split(' ').forEach(c => e.classList.add(c))\n\t\t});\n\t}\n\n\tremoveClass(clazz) {\n\t\treturn this.exec(e => {\n\t\t\tclazz.split(' ').forEach(c => e.classList.remove(c))\n\t\t});\n\t}\n\n\thasClass(clazz) {\n\t\tlet hasClass = false;\n\t\tthis.exec(e => hasClass = e.classList.contains(clazz));\n\t\treturn hasClass\n\t}\n\n\tstyle(style) {\n\t\treturn this.exec(e => e.style = style)\n\t}\n\n\tcreateElement(el, content) {\n\t\treturn this.exec(e => e.appendChild(document.createElement(el)).innerHTML = content);\n\t}\n\n\tappendChild(el) {\n\t\treturn this.exec(e => e.appendChild(el));\n\t}\n\n\treplace(what, to) {\n\t\treturn this.exec(e => e.innerHTML = e.innerHTML.replace(what, to));\n\t}\n\n\tappend(content) {\n\t\treturn this.exec(e => e.innerHTML = e.innerHTML + content)\n\t}\n\n\texec(callback) {\n\t\tif (typeof this.el !== 'object') {\n\t\t\tdocument.querySelectorAll(this.el).forEach(e => {\n\t\t\t\tcallback(e)\n\t\t\t});\n\t\t} else {\n\t\t\tcallback(this.el)\n\t\t}\n\n\t\treturn x(this.el)\n\t}\n}\n\nclass Yavir {\n\tconstructor(el) {\n\t\tthis.app = el;\n\t}\n\n\tmatch(path, route) {\n\t\tlet names = path.match(new RegExp('{([a-zA-Z0-9]+)}', 'g'));\n\n\t\tpath = path\n\t\t\t.replace(new RegExp('{([a-zA-Z]+)}', 'g'), '(.+)')\n\t\t\t.replace(new RegExp('{([a-zA-Z]+)\\((.+)\\)}', 'g'), /\\2/);\n\n\t\tlet params = route.match(new RegExp('^' + path + '$'));\n\n\t\t$route['path'] = route;\n\n\t\tif (params !== null && names !== null)\n\t\t\tfor (let i = 1; i <= names.length; i++)\n\t\t\t\t$route[names[i - 1].replace('{', '').replace('}', '')] = params[i];\n\n\t\treturn params !== null;\n\t}\n\n\trenderComponent(component) {\n\t\tlet tpl = (\"function\" === typeof component.template) ? component.template() : component.template;\n\n\t\tlet start = tpl.indexOf('<script load>');\n\t\tlet end = tpl.substr(start, tpl.length).indexOf('</script>');\n\n\t\tx(component.selector).html(tpl);\n\n\t\tif (start > 0 && end > 0)\n\t\t\twindow.eval(tpl.substr(start + 13, end - 13));\n\t\telse if (component.script)\n\t\t\tcomponent.script();\n\n\t\tx(component.selector).replace(new RegExp('{{([a-zA-Z0-9 ]+)}}', 'g'), (q, val) => {\n\t\t\tval = $data[val.trim()];\n\t\t\treturn typeof val === 'function' ? val() : val\n\t\t});\n\n\t\tif (component.title) {\n\t\t\twindow.document.title = component.title;\n\t\t} else {\n\t\t\tx('title[load]').exec(x => window.document.title = x.innerHTML);\n\t\t}\n\n\t\tif (component.style)\n\t\t\tx(component.selector).createElement('style', component.style);\n\n\t\tif (component.components !== null && \"undefined\" !== typeof component.components) {\n\t\t\tcomponent.components.forEach(function (c) {\n\t\t\t\tthis.renderComponent(c);\n\t\t\t});\n\t\t}\n\t}\n\n\trenderActive() {\n\t\tx('*').removeClass('active-route');\n\n\t\tlet found = this.app.components.find(e => {\n\t\t\tif ($mode === 'hash') {\n\t\t\t\treturn typeof e.route === 'undefined' ? false : this.match(e.route, window.location.hash.substr(1, window.location.hash.length));\n\t\t\t} else {\n\t\t\t\treturn typeof e.route === 'undefined' ? false : this.match(e.route, window.location.pathname);\n\t\t\t}\n\t\t});\n\n\t\tif (found) {\n\t\t\tx(this.app.el).html('<' + found.selector + '>' + '</' + found.selector + '>');\n\n\t\t\tthis.renderComponent(found);\n\n\t\t\tx('.' + found.selector.replace('-', '_')).addClass('active-route')\n\t\t} else {\n\t\t\tx('view').html('404')\n\t\t}\n\t}\n\n\trun() {\n\t\t$mode = this.app.mode;\n\n\t\tif ($mode === 'hash' && window.location.hash === \"\") {\n\t\t\thistory.replaceState({}, '', '#/');\n\t\t}\n\n\t\tfor (const e of this.app.components) {\n\t\t\tif (e.route === undefined)\n\t\t\t\tx(e.selector).html(typeof e.template === 'function' ? e.template() : e.template);\n\t\t}\n\n\t\tif (typeof this.app.path === 'undefined') this.app.path = '/';\n\n\t\tthis.renderActive();\n\n\t\tx(window).on($mode === 'hash' ? 'hashchange' : 'popstate', () => {\n\t\t\tthis.renderActive()\n\t\t});\n\t}\n}\n\nfunction url(href) {\n\tif ($mode === 'hash') {\n\t\twindow.location.hash = href\n\t} else {\n\t\thistory.pushState({}, '', href);\n\t\twindow.dispatchEvent(new Event('popstate'));\n\t}\n\n\treturn false\n}\n\nfunction page(file, async = false) {\n\tlet rawFile = new XMLHttpRequest();\n\tlet s;\n\trawFile.open(\"GET\", file, async);\n\trawFile.onreadystatechange = function () {\n\t\tif (rawFile.readyState === 4) {\n\t\t\tif (rawFile.status === 200 || rawFile.status === 0) {\n\t\t\t\ts = rawFile.responseText;\n\t\t\t}\n\t\t}\n\t};\n\trawFile.send(null);\n\treturn s;\n}\n\nfunction log(...text) {\n\ttext.forEach(function (e) {\n\t\tconsole.log(e);\n\t});\n}"]}